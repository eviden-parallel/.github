# This is the workflow to lint the source code
name: Lint Code

# Controls when the action will run.
on:
  # Allows you to call this workflow from other workflows
  workflow_call:
    secrets:
      NPM_TOKEN:
        required: true

  # Allows you to run this workflow manually from the Actions tab
  workflow_dispatch:

permissions:
  contents: read

jobs:
  lint:
    name: 'üïµÔ∏è‚Äç‚ôÇÔ∏è Lint Code'
    runs-on: ubuntu-latest
    # container: node:lts-bullseye

    permissions:
      contents: read
      packages: read

    steps:
      - name: '‚òÅÔ∏è Checkout repository'
        uses: actions/checkout@v4
        with:
          ref: ${{ github.event.workflow_run.head_sha || github.event.pull_request.head.sha }}
          persist-credentials: false

      - name: '‚õìÔ∏è Install dependencies'
        uses: eviden-actions/npm-ci@v1
        with:
          npm_proxy: ${{ vars.NPM_PROXY }}
          private_registry_url: https://npm.pkg.github.com/
          private_registry_scope: '@eviden-parallel'
          token: ${{ secrets.NPM_TOKEN || secrets.GITHUB_TOKEN }}

      - name: '‚úÖ Lint code'
        run: npm run lint
